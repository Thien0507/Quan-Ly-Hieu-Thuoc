<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!--  -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
    <!--  -->

      <!-- Giao dien chia 3 -->
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
      <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  
  
      <!-- search -->
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/selectize.js/0.12.6/js/standalone/selectize.min.js" integrity="sha256-+C0A5Ilqmu4QcSPxrlGpaZxJ04VjsRjKu+G82kl5UJk=" crossorigin="anonymous"></script>
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/selectize.js/0.12.6/css/selectize.bootstrap3.min.css" integrity="sha256-ze/OEYGcFbPRmvCnrSeKbRTtjG4vGLHXgOqsyLFTRjg=" crossorigin="anonymous" />
      <!--  -->

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link rel="stylesheet" href="/css/homepage.css" />
    <link rel="stylesheet" href="/css/distributorspage.css" />
    <style></style>
    <title>Nhập kho thuốc</title>
  </head>
  <body>
    <div class="topnav" id="myTopnav">
      <a href="http://localhost:3000/homepage"">Trang Chủ</a>
      <a href="http://localhost:3000/managepage">Quản Lý Thuốc</a>
      <a href="http://localhost:3000/sellpage" >Bán Thuốc</a>
      <a href="http://localhost:3000/importpage">Nhập Kho Thuốc</a>
      <a href="http://localhost:3000/clientspage">Khách Hàng </a>
      <a href="http://localhost:3000/userspage">Tài Khoản</a>
      <a href="http://localhost:3000/distributorspage" class="active">Nhà Phân Phối</a>
      <a href="http://localhost:3000/statisticalpage">Thống Kê</a>
      <input
      id="search"
      type="text" 
      placeholder="Tìm kiếm" 
      style="height: 40px;
             width: 300px;
             align-items: center;
             margin-top: 14px;" 
      name="search">
      <div class="dropdown" style="float: right">
        <button class="dropbtn">
          <%=currentUser%>
          <i class="fa fa-caret-down"></i>
        </button>
        <div class="dropdown-content">
          <a href="javascript:void(0);">Log out</a>
        </div>
      </div>

      <a href="javascript:void(0);" class="icon" onclick="myFunction()">
        <i class="fa fa-bars"></i>
      </a>
    </div>

    <div class="main" style="margin-top: 66px">
      <div class="container-xl">
      </div>
      <div class="table-responsive">
        <div class="table-wrapper">
          <div class="table-title">
            <div class="row">
              <div class="col-sm-6">
                <h2>Quản lý <b>Nhà Phân Phối</b></h2>
              </div>
              <div class="col-sm-6">
                <a href="#addEmployeeModal" class="btn btn-success" data-toggle="modal"><i class="material-icons">&#xE147;</i> <span>Thêm nhà phân phôi</span></a>
                <!-- <a href="#deleteEmployeeModal" class="btn btn-danger" data-toggle="modal"><i class="material-icons">&#xE15C;</i> <span>Xóa nhà phân phối</span></a>						 -->
              </div>
            </div>
          </div>
          <table class="table table-striped table-hover">
            <thead>
              <tr>
                <th style="display: none">
                  <span class="custom-checkbox">
                    <input type="checkbox" id="selectAll">
                    <label for="selectAll"></label>
                  </span>
                </th>
                <th>Name</th>
                <th>Address</th>
                <th>Phone</th>
                <th>Fax</th>
                <th>Email</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <% for(let i = 0; i < distributors.length; i++) { %> 
                <tr class="row-client <%= "item" + Number(i) %>">
                  <td style="display: none">
                    <span class="custom-checkbox" >
                      <input type="checkbox" id=<%="checkbox" + distributors[i].IDNhaPhanPhoi %> name="options[]" value="1">
                      <label for=<%="checkbox" + distributors[i].IDNhaPhanPhoi %>></label>
                    </span>
                  </td>
                  <td><%=distributors[i].TenNPP%></td>
                  <td><%=distributors[i].DiaChi%></td>
                  <td><%=distributors[i].DienThoai%></td>
                  <td><%=distributors[i].Fax%></td>
                  <td><%=distributors[i].Email%></td>
                  <td>
                    <a href="#editEmployeeModal" class="edit" id=<%="edit" + distributors[i].IDNhaPhanPhoi %> data-toggle="modal"><i class="material-icons" data-toggle="tooltip" title="Edit">&#xE254;</i></a>
                    <a href="#deleteEmployeeModal" class="delete" id=<%="delete" + distributors[i].IDNhaPhanPhoi %> data-toggle="modal"><i class="material-icons" data-toggle="tooltip" title="Delete">&#xE872;</i></a>
                  </td>
                </tr>
              <% } %>
            </tbody>
          </table>


          <div class="clearfix">
            <div class="hint-text">Hiển thị <b>10</b> trên <b><%=distributors.length%></b> khách hàng</div>
            <ul class="pagination">
              <li class="page-item disabled"><a href="#">Previous</a></li>
              <% for (let j = 0; j < Math.ceil(distributors.length / 10); j ++) {%>
                <%  if (j == 0){%>
                  <li class="page-item active"><a href="#" class="page-link"><%=j+1%></a></li>
                <% } else { %>
                  <li class="page-item"><a href="#" class="page-link"><%=j+1%></a></li>
                <% } %>
              <% } %>
              <!-- <li class="page-item"><a href="#" class="page-link">1</a></li>
              <li class="page-item"><a href="#" class="page-link">2</a></li>
              <li class="page-item active"><a href="#" class="page-link">3</a></li>
              <li class="page-item"><a href="#" class="page-link">4</a></li>
              <li class="page-item"><a href="#" class="page-link">5</a></li> -->
              <li class="page-item"><a href="#" class="page-link">Next</a></li>
            </ul>
          </div>

        </div>
      </div>        
      <!-- Edit Modal HTML -->
      <div id="addEmployeeModal" class="modal fade">
        <div class="modal-dialog">
          <div class="modal-content">
            <form>
              <div class="modal-header">						
                <h4 class="modal-title">Thêm nhà phân phối</h4>
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
              </div>
              <div class="modal-body">					
                <div class="form-group">
                  <label>Name</label>
                  <input type="text" class="form-control" required>
                </div><div class="form-group">
                  <label>Address</label>
                  <input type="text" class="form-control" required>
                </div>
                <div class="form-group">
                  <label>Phone</label>
                  <input type="text" class="form-control" required>
                </div>	
                <div class="form-group">
                  <label>Fax</label>
                  <input type="text" class="form-control" required>
                </div>
                <div class="form-group">
                  <label>Email</label>
                  <input type="email" class="form-control" required>
                </div>				
              </div>
              <div class="modal-footer">
                <input type="button" class="btn btn-default" data-dismiss="modal" value="Cancel">
                <input type="submit" class="btn btn-success" value="Add">
              </div>
            </form>
          </div>
        </div>
      </div>
      <!-- Edit Modal HTML -->
      <div id="editEmployeeModal" class="modal fade">
        <div class="modal-dialog">
          <div class="modal-content">
            <form>
              <div class="modal-header">						
                <h4 class="modal-title">Chỉnh sửa nhà phân phối</h4>
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
              </div>
              <div class="modal-body">					
                <div class="form-group">
                  <label>Name</label>
                  <input type="text" class="form-control" required>
                </div><div class="form-group">
                  <label>Address</label>
                  <input type="text" class="form-control" required>
                </div>
                <div class="form-group">
                  <label>Phone</label>
                  <input type="text" class="form-control" required>
                </div>	
                <div class="form-group">
                  <label>Fax</label>
                  <input type="text" class="form-control" required>
                </div>
                <div class="form-group">
                  <label>Email</label>
                  <input type="email" class="form-control" required>
                </div>
              </div>
              <div class="modal-footer">
                <input type="button" class="btn btn-default" data-dismiss="modal" value="Cancel">
                <input type="submit" class="btn btn-info" value="Save">
              </div>
            </form>
          </div>
        </div>
      </div>
      <!-- Delete Modal HTML -->
      <div id="deleteEmployeeModal" class="modal fade">
        <div class="modal-dialog">
          <div class="modal-content">
            <form>
              <div class="modal-header">						
                <h4 class="modal-title">Xóa nhà phân phối</h4>
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
              </div>
              <div class="modal-body">					
                <p>Bạn có chắc chắn muốn xóa mục đã chọn</p>
                <p class="text-warning"><small>Hành động này không thể hoàn tác.</small></p>
              </div>
              <div class="modal-footer">
                <input type="button" class="btn btn-default" data-dismiss="modal" value="Hủy bỏ">
                <input type="submit" class="btn btn-danger" value="Xóa">
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <script>
      // search input
      const hintText = document.getElementsByClassName("hint-text")[0];
      let quantitySorted = 0;
  
      let search = document.getElementById("search");
      let rows = document.getElementsByTagName("tbody")[0].getElementsByTagName("tr");
      search.addEventListener("keyup", () => {
        for (let i = 0; i < rows.length; i++) {
          if (
            rows[i].children[1].innerText
              .toLowerCase()
              .trim()
              .includes(search.value.toLowerCase().trim())
            && search.value.toLowerCase().trim()
          ) {
            !rows[i].classList.contains("sorted") ? rows[i].classList.add("sorted") : '';
          } else {
            rows[i].classList.contains("sorted") ? rows[i].classList.remove("sorted") : '';
          }
        }
        if (search.value.toLowerCase().trim()) {
          quantitySorted = document.getElementsByClassName("sorted").length;
        } else {
          quantitySorted = 0;
        }
        hintText.innerHTML = `Hiển thị <b>5</b> trên <b>${search.value.toLowerCase().trim() ? quantitySorted : rows.length}</b> khách hàng`
        setCurrentState(currentTab)
      });
  
      // Pagination
  
      // const hdnPage = document.getElementsByClassName("hdn-page")[0];
        const tables = document.getElementsByTagName("tbody")[0];
        const items = tables.getElementsByClassName("row-client")
  
        const pagination = document.getElementsByClassName("pagination")[0];
        const pages = pagination.getElementsByClassName("page-item");
        let activePage = pagination.getElementsByClassName("active")[0];
  
        let beforeTab = 1;
        let afterTab = 2;
        
        let currentTab = 1;
  
        let count = 0;
        const setCurrentState = (currentTab) => {
          count = 0;
          for (let i = 0; i < items.length; i++) {
          if (search.value === "") {
            if (i >= (currentTab - 1) * 10 && i < currentTab * 10) {
              items[i].style.display = ""
            } else {
              items[i].style.display = "none"
            }
          } else {
            if (items[i].classList.contains("sorted"))  {
              (count >= (currentTab - 1) * 10 && count < currentTab * 10) ? items[i].style.display = "" : items[i].style.display = "none";
              count++;
            } else {
              items[i].style.display = "none"
            }
          }
  
          if (currentTab >= 2) {
          pages[0].classList.contains("disabled")
            ? pages[0].classList.toggle("disabled")
            : pages[0].classList;
          }
        afterTab = 2;
        beforeTab = 1;
        if (currentTab == 1) {
          pages[0].classList.contains("disabled")
            ? pages[0].classList
            : pages[0].classList.toggle("disabled");
          afterTab = 3;
          beforeTab = 0;
        }
        if (currentTab  == pages.length - 3) {
          afterTab = 1;
          beforeTab = 2;
        }
        if (currentTab  == pages.length - 2) {
          afterTab = 1;
          beforeTab = 3;
        }
        for (let i = 1; i < pages.length - 1; i++) {
          if (i >= currentTab  * 1 - beforeTab && i <= currentTab  * 1 + afterTab) {
            pages[i].style.display = "";
          } else if (i <= pages.length - 2) {
            pages[i].style.display = "none";
          }
        }
        }
      }
      setCurrentState(currentTab);
    for (let index in pages) {
      if (index == 0) {
        pages[index].addEventListener("click", () => {
          if (currentTab  >=2) {
            activePage.classList.toggle("active");
            pages[currentTab - 1].classList.toggle("active");
            activePage = pages[currentTab - 1];
            currentTab--;
            setCurrentState(currentTab);
          }
        });
      }
      if (index == pages.length  - 1) {
        pages[index].addEventListener("click", () => {
          if (currentTab  < pages.length - 2) {
            activePage.classList.toggle("active");
            pages[currentTab + 1].classList.toggle("active");
            activePage = pages[currentTab + 1];
            currentTab++;
            setCurrentState(currentTab);
          }
        });
      }
      if (index > 0 && index <= pages.length  - 2) {
        pages[index].addEventListener("click", () => {
          activePage.classList.toggle("active");
          pages[index].classList.toggle("active");
          activePage = pages[index];
          currentTab = index;
          setCurrentState(currentTab);
        });
      }
  }
    </script>
    <script src="/js/distributorspage.js"></script>
  </body>
</html>
